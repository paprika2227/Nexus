<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Setup Wizard - Nexus Bot</title>
    <link
      rel="icon"
      type="image/webp"
      href="https://cdn.discordapp.com/avatars/1444739230679957646/32f2d77d44c2f3989fecd858be53f396.webp?size=256"
    />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="pages.css" />
    <style>
      .wizard-container {
        max-width: 900px;
        margin: 100px auto;
        padding: 40px;
      }

      .progress-bar {
        background: rgba(0, 0, 0, 0.3);
        height: 10px;
        border-radius: 10px;
        margin-bottom: 40px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #00d1b2 100%);
        transition: width 0.5s ease;
      }

      .progress-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 50px;
      }

      .progress-step {
        flex: 1;
        text-align: center;
        position: relative;
        padding: 10px;
      }

      .progress-step::before {
        content: attr(data-step);
        display: block;
        width: 50px;
        height: 50px;
        line-height: 50px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: 3px solid rgba(255, 255, 255, 0.3);
        margin: 0 auto 10px;
        font-weight: 900;
        font-size: 1.5rem;
        transition: all 0.3s;
      }

      .progress-step.active::before {
        background: #667eea;
        border-color: #667eea;
        box-shadow: 0 0 20px #667eea;
      }

      .progress-step.completed::before {
        content: "‚úì";
        background: #00d1b2;
        border-color: #00d1b2;
      }

      .step-label {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .step-content {
        display: none;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        padding: 40px;
        border-radius: 20px;
        border: 2px solid rgba(255, 255, 255, 0.2);
      }

      .step-content.active {
        display: block;
        animation: fadeIn 0.5s;
      }

      .step-content h2 {
        font-size: 2rem;
        margin-bottom: 20px;
      }

      .step-content p {
        font-size: 1.1rem;
        opacity: 0.9;
        margin-bottom: 30px;
        line-height: 1.8;
      }

      .code-box {
        background: rgba(0, 0, 0, 0.4);
        padding: 20px;
        border-radius: 10px;
        font-family: monospace;
        font-size: 1.1rem;
        margin: 20px 0;
        border-left: 4px solid #667eea;
      }

      .btn-wizard {
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: 700;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
        margin: 10px;
      }

      .btn-next {
        background: #00d1b2;
        color: white;
      }

      .btn-next:hover {
        background: #00b89c;
        transform: translateY(-2px);
      }

      .btn-back {
        background: rgba(255, 255, 255, 0.2);
        color: white;
      }

      .btn-back:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .checklist {
        background: rgba(0, 0, 0, 0.3);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }

      .checklist-item {
        padding: 15px;
        margin: 10px 0;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .checklist-item.completed {
        background: rgba(0, 209, 178, 0.2);
        border-left: 4px solid #00d1b2;
      }

      .completion-banner {
        text-align: center;
        padding: 60px;
        background: linear-gradient(
          135deg,
          rgba(0, 209, 178, 0.3) 0%,
          rgba(102, 126, 234, 0.3) 100%
        );
        border-radius: 20px;
        border: 3px solid #00d1b2;
      }

      .completion-banner h2 {
        font-size: 3rem;
        margin-bottom: 20px;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <div class="wizard-container">
      <h1 style="text-align: center; font-size: 3rem; margin-bottom: 10px">
        üöÄ Nexus Setup Wizard
      </h1>
      <p
        style="
          text-align: center;
          opacity: 0.9;
          font-size: 1.2rem;
          margin-bottom: 40px;
        "
      >
        Get fully protected in 5 minutes
      </p>

      <!-- Progress Bar -->
      <div class="progress-bar">
        <div class="progress-fill" id="progressBar"></div>
      </div>

      <!-- Progress Steps -->
      <div class="progress-steps">
        <div class="progress-step active" data-step="1">
          <div class="step-label">Invite</div>
        </div>
        <div class="progress-step" data-step="2">
          <div class="step-label">Setup</div>
        </div>
        <div class="progress-step" data-step="3">
          <div class="step-label">Configure</div>
        </div>
        <div class="progress-step" data-step="4">
          <div class="step-label">Test</div>
        </div>
        <div class="progress-step" data-step="5">
          <div class="step-label">Complete</div>
        </div>
      </div>

      <!-- Step 1: Invite -->
      <div class="step-content active" id="step1">
        <h2>Step 1: Invite Nexus to Your Server</h2>
        <p>
          Click the button below to invite Nexus with all required permissions.
          Make sure you have "Manage Server" permission on your Discord server.
        </p>

        <div style="text-align: center; margin: 40px 0">
          <a
            href="https://discord.com/oauth2/authorize?client_id=1444739230679957646&permissions=268443574&scope=bot%20applications.commands"
            target="_blank"
            class="btn btn-primary"
            style="font-size: 1.2rem; padding: 20px 50px"
            onclick="markInvited()"
          >
            ü§ñ Invite Nexus Now
          </a>
        </div>

        <div class="checklist">
          <h3 style="margin-bottom: 15px">‚úÖ Required Permissions:</h3>
          <div class="checklist-item">
            <span>üõ°Ô∏è</span>
            <span>Manage Roles - For anti-nuke protection</span>
          </div>
          <div class="checklist-item">
            <span>‚öîÔ∏è</span>
            <span>Ban Members - For anti-raid</span>
          </div>
          <div class="checklist-item">
            <span>üë•</span>
            <span>Kick Members - For moderation</span>
          </div>
          <div class="checklist-item">
            <span>üìù</span>
            <span>Manage Channels - For logging and recovery</span>
          </div>
        </div>

        <div style="text-align: center; margin-top: 40px">
          <button class="btn-wizard btn-next" onclick="nextStep()">
            Next Step ‚Üí
          </button>
        </div>
      </div>

      <!-- Step 2: Run Setup Command -->
      <div class="step-content" id="step2">
        <h2>Step 2: Run the Setup Command</h2>
        <p>
          In your Discord server, run the <code>/setup</code> command to create
          essential channels and configure basic protection.
        </p>

        <div class="code-box">/setup</div>

        <div class="checklist">
          <h3 style="margin-bottom: 15px">What this does:</h3>
          <div class="checklist-item">
            <span>üìù</span>
            <span>Creates mod log channel</span>
          </div>
          <div class="checklist-item">
            <span>üîí</span>
            <span>Creates security log channel</span>
          </div>
          <div class="checklist-item">
            <span>‚öôÔ∏è</span>
            <span>Enables basic protection features</span>
          </div>
          <div class="checklist-item">
            <span>üéØ</span>
            <span>Sets recommended defaults</span>
          </div>
        </div>

        <div
          style="
            background: rgba(255, 215, 0, 0.2);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #ffd700;
            margin: 20px 0;
          "
        >
          <strong>üí° Pro Tip:</strong> You can customize everything later in the
          dashboard!
        </div>

        <div style="text-align: center; margin-top: 40px">
          <button class="btn-wizard btn-back" onclick="prevStep()">
            ‚Üê Back
          </button>
          <button class="btn-wizard btn-next" onclick="nextStep()">
            Next Step ‚Üí
          </button>
        </div>
      </div>

      <!-- Step 3: Configure Protection -->
      <div class="step-content" id="step3">
        <h2>Step 3: Choose Your Protection Level</h2>
        <p>
          Select a template that matches your server type, or go to the
          dashboard for custom configuration.
        </p>

        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
          "
        >
          <div
            style="
              background: rgba(255, 255, 255, 0.05);
              padding: 25px;
              border-radius: 15px;
              border: 2px solid rgba(255, 255, 255, 0.2);
              text-align: center;
              cursor: pointer;
              transition: all 0.3s;
            "
            onclick="selectTemplate('gaming')"
          >
            <div style="font-size: 3rem; margin-bottom: 10px">üéÆ</div>
            <h3>Gaming Server</h3>
            <p style="font-size: 0.9rem; opacity: 0.8; margin: 10px 0">
              Full protection recommended for gaming communities
            </p>
          </div>

          <div
            style="
              background: rgba(255, 255, 255, 0.05);
              padding: 25px;
              border-radius: 15px;
              border: 2px solid rgba(255, 255, 255, 0.2);
              text-align: center;
              cursor: pointer;
              transition: all 0.3s;
            "
            onclick="selectTemplate('community')"
          >
            <div style="font-size: 3rem; margin-bottom: 10px">üí¨</div>
            <h3>Community</h3>
            <p style="font-size: 0.9rem; opacity: 0.8; margin: 10px 0">
              Balanced protection for community servers
            </p>
          </div>

          <div
            style="
              background: rgba(255, 255, 255, 0.05);
              padding: 25px;
              border-radius: 15px;
              border: 2px solid rgba(255, 255, 255, 0.2);
              text-align: center;
              cursor: pointer;
              transition: all 0.3s;
            "
            onclick="selectTemplate('custom')"
          >
            <div style="font-size: 3rem; margin-bottom: 10px">‚öôÔ∏è</div>
            <h3>Custom</h3>
            <p style="font-size: 0.9rem; opacity: 0.8; margin: 10px 0">
              Configure manually in the dashboard
            </p>
          </div>
        </div>

        <div
          id="template-selected"
          style="
            display: none;
            background: rgba(0, 209, 178, 0.2);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00d1b2;
            margin: 20px 0;
            text-align: center;
          "
        >
          <h3 style="color: #00d1b2">‚úÖ Template Selected!</h3>
          <p id="template-name" style="margin-top: 10px"></p>
        </div>

        <div style="text-align: center; margin-top: 40px">
          <button class="btn-wizard btn-back" onclick="prevStep()">
            ‚Üê Back
          </button>
          <button class="btn-wizard btn-next" onclick="nextStep()">
            Next Step ‚Üí
          </button>
        </div>
      </div>

      <!-- Step 4: Test & Verify -->
      <div class="step-content" id="step4">
        <h2>Step 4: Test Your Protection</h2>
        <p>
          Let's verify everything is working correctly. Run these quick tests:
        </p>

        <div class="checklist">
          <h3 style="margin-bottom: 15px">Quick Tests:</h3>

          <div class="checklist-item">
            <input
              type="checkbox"
              id="test1"
              style="width: 24px; height: 24px"
              onchange="updateTestProgress()"
            />
            <div>
              <strong>Test 1: Check Bot Status</strong><br />
              <span style="opacity: 0.8"
                >Run <code>/ping</code> - Bot should respond instantly</span
              >
            </div>
          </div>

          <div class="checklist-item">
            <input
              type="checkbox"
              id="test2"
              style="width: 24px; height: 24px"
              onchange="updateTestProgress()"
            />
            <div>
              <strong>Test 2: View Configuration</strong><br />
              <span style="opacity: 0.8"
                >Run <code>/config</code> - Check your settings</span
              >
            </div>
          </div>

          <div class="checklist-item">
            <input
              type="checkbox"
              id="test3"
              style="width: 24px; height: 24px"
              onchange="updateTestProgress()"
            />
            <div>
              <strong>Test 3: Check Logs</strong><br />
              <span style="opacity: 0.8"
                >Verify mod log and security log channels were created</span
              >
            </div>
          </div>

          <div class="checklist-item">
            <input
              type="checkbox"
              id="test4"
              style="width: 24px; height: 24px"
              onchange="updateTestProgress()"
            />
            <div>
              <strong>Test 4: Dashboard Access</strong><br />
              <span style="opacity: 0.8"
                >Login to
                <a
                  href="https://regular-puma-clearly.ngrok-free.app"
                  style="color: #ffd700"
                  >dashboard</a
                >
                and view your server</span
              >
            </div>
          </div>
        </div>

        <div
          id="tests-complete"
          style="
            display: none;
            background: rgba(0, 209, 178, 0.2);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00d1b2;
            margin: 20px 0;
            text-align: center;
          "
        >
          <h3 style="color: #00d1b2">‚úÖ All Tests Passed!</h3>
          <p style="margin-top: 10px">Your server is fully protected!</p>
        </div>

        <div style="text-align: center; margin-top: 40px">
          <button class="btn-wizard btn-back" onclick="prevStep()">
            ‚Üê Back
          </button>
          <button class="btn-wizard btn-next" onclick="nextStep()">
            Finish Setup ‚Üí
          </button>
        </div>
      </div>

      <!-- Step 5: Complete -->
      <div class="step-content" id="step5">
        <div class="completion-banner">
          <h2>üéâ Setup Complete!</h2>
          <p style="font-size: 1.3rem; opacity: 0.9; margin: 20px 0">
            Your server is now protected by Nexus!
          </p>

          <div
            style="
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
              gap: 20px;
              margin: 40px 0;
              text-align: left;
            "
          >
            <div
              style="
                background: rgba(0, 0, 0, 0.3);
                padding: 20px;
                border-radius: 10px;
              "
            >
              <div style="font-size: 2rem; margin-bottom: 10px">üõ°Ô∏è</div>
              <h3>Anti-Nuke</h3>
              <p style="opacity: 0.8; font-size: 0.9rem">
                Protecting against mass deletions
              </p>
            </div>
            <div
              style="
                background: rgba(0, 0, 0, 0.3);
                padding: 20px;
                border-radius: 10px;
              "
            >
              <div style="font-size: 2rem; margin-bottom: 10px">‚öîÔ∏è</div>
              <h3>Anti-Raid</h3>
              <p style="opacity: 0.8; font-size: 0.9rem">
                Blocking coordinated attacks
              </p>
            </div>
            <div
              style="
                background: rgba(0, 0, 0, 0.3);
                padding: 20px;
                border-radius: 10px;
              "
            >
              <div style="font-size: 2rem; margin-bottom: 10px">üì∏</div>
              <h3>Auto-Snapshots</h3>
              <p style="opacity: 0.8; font-size: 0.9rem">
                Hourly backups running
              </p>
            </div>
          </div>

          <h3 style="margin: 30px 0 20px">What's Next?</h3>
          <div
            style="
              display: flex;
              gap: 15px;
              justify-content: center;
              flex-wrap: wrap;
            "
          >
            <a
              href="https://regular-puma-clearly.ngrok-free.app"
              target="_blank"
              class="btn btn-primary"
              style="padding: 15px 30px"
            >
              üéõÔ∏è Open Dashboard
            </a>
            <a
              href="commands.html"
              class="btn btn-secondary"
              style="padding: 15px 30px"
            >
              üìñ Browse Commands
            </a>
            <a
              href="https://discord.gg/EvFMz4VQPx"
              target="_blank"
              class="btn btn-secondary"
              style="padding: 15px 30px"
            >
              üí¨ Join Support
            </a>
          </div>

          <div
            style="
              margin-top: 40px;
              padding: 20px;
              background: rgba(255, 215, 0, 0.2);
              border-radius: 10px;
              border: 2px solid #ffd700;
            "
          >
            <h4 style="color: #ffd700; margin-bottom: 10px">‚ö° Pro Tips:</h4>
            <ul style="text-align: left; margin: 15px 0; padding-left: 40px">
              <li>
                Use <code>/recommend</code> to get AI-powered security
                suggestions
              </li>
              <li>Set up logging channels for full audit trails</li>
              <li>Enable vote rewards to encourage community voting</li>
              <li>Join our Discord for tips and support</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 1;
      const totalSteps = 5;
      let selectedTemplate = null;

      // Load saved progress
      const savedStep = localStorage.getItem("nexus-setup-step");
      if (savedStep) {
        currentStep = parseInt(savedStep);
        showStep(currentStep);
      }

      function nextStep() {
        if (currentStep < totalSteps) {
          currentStep++;
          saveProgress();
          showStep(currentStep);
        }
      }

      function prevStep() {
        if (currentStep > 1) {
          currentStep--;
          saveProgress();
          showStep(currentStep);
        }
      }

      function showStep(step) {
        // Hide all steps
        document
          .querySelectorAll(".step-content")
          .forEach((s) => s.classList.remove("active"));

        // Show current step
        document.getElementById(`step${step}`).classList.add("active");

        // Update progress bar
        const progress = (step / totalSteps) * 100;
        document.getElementById("progressBar").style.width = progress + "%";

        // Update step indicators
        document.querySelectorAll(".progress-step").forEach((el, i) => {
          el.classList.remove("active", "completed");
          if (i + 1 < step) {
            el.classList.add("completed");
          } else if (i + 1 === step) {
            el.classList.add("active");
          }
        });
      }

      function saveProgress() {
        localStorage.setItem("nexus-setup-step", currentStep);
      }

      function markInvited() {
        setTimeout(() => {
          nextStep();
        }, 1000);
      }

      async function selectTemplate(template) {
        selectedTemplate = template;
        document.getElementById("template-selected").style.display = "block";

        const names = {
          gaming: "üéÆ Gaming Server Template",
          community: "üí¨ Community Server Template",
          custom: "‚öôÔ∏è Custom Configuration (use dashboard)",
        };

        document.getElementById("template-name").textContent = names[template];

        // If not custom, apply configuration via API
        if (template !== "custom") {
          try {
            // Get guild ID from URL or user session (would need auth integration)
            const guildId = new URLSearchParams(window.location.search).get(
              "guildId"
            );
            if (guildId) {
              const response = await fetch(
                `https://regular-puma-clearly.ngrok-free.app/api/v2/setup/auto-configure`,
                {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/json",
                    "ngrok-skip-browser-warning": "true",
                  },
                  body: JSON.stringify({ guildId, template }),
                }
              );
              const data = await response.json();
              if (data.success) {
                console.log("Configuration applied:", data.data);
              }
            }
          } catch (error) {
            console.error("Failed to apply template:", error);
          }
        }
      }

      function updateTestProgress() {
        const tests = [
          document.getElementById("test1").checked,
          document.getElementById("test2").checked,
          document.getElementById("test3").checked,
          document.getElementById("test4").checked,
        ];

        const allComplete = tests.every((t) => t);

        if (allComplete) {
          document.getElementById("tests-complete").style.display = "block";

          // Mark checklist items as completed
          tests.forEach((checked, i) => {
            if (checked) {
              document
                .querySelectorAll(".checklist-item")
                [i].classList.add("completed");
            }
          });
        } else {
          document.getElementById("tests-complete").style.display = "none";
        }
      }

      // Clear progress on completion
      if (currentStep === totalSteps) {
        localStorage.removeItem("nexus-setup-step");
      }
    </script>
  </body>
</html>
